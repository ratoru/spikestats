{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// This file provides helper functions to tranform the data from the server\n// into data the react components can use.\n// Takes in a Game and converts it to the format used in the GameTable.\nexport function gameToRow(game, players) {\n  return {\n    id: game[\"id\"],\n    blueTeam: teamToString(game[\"blueTeam\"], players),\n    redTeam: teamToString(game[\"redTeam\"], players),\n    score: game[\"score\"].join(\":\"),\n    serve: game[\"serve\"],\n    date: game[\"date\"]\n  };\n}\n\nfunction teamToString(team, players) {\n  return team.map(playerId => players.get(playerId)).join(\", \");\n} // Takes in a list of Games and returns serveData.\n\n\nexport function getServeData(games) {\n  const winPercentage = getServeWinPercentage(games);\n  return [{\n    name: \"No Serve\",\n    value: 100 - winPercentage,\n    disabled: true\n  }, {\n    name: \"Serve\",\n    value: winPercentage\n  }];\n} // Takes in a list of Games and returns the win percentage of the team\n// with the inital serve.\n\nfunction getServeWinPercentage(games) {\n  const wins = games.filter(game => {\n    return game.score[game.serve] > game.score[game.serve ? 0 : 1];\n  }).length;\n  const total = games.length;\n  return wins / total * 100;\n} // Takes in a list of games and all players, and returns how many points\n// each player scored.\n\n\nexport function getPlayerPointsData(games, players) {\n  const data = []; // Should be of key: id, value: points.\n\n  const points = new Map(Array.from(players.keys()).map(key => [key, 0]));\n\n  for (let game of games) {\n    const scoreBlue = game.score[0];\n    const scoreRed = game.score[1];\n    points.set(game.blueTeam[0], points.get(game.blueTeam[0]) + scoreBlue);\n    points.set(game.blueTeam[1], points.get(game.blueTeam[1]) + scoreBlue);\n    points.set(game.redTeam[0], points.get(game.redTeam[0]) + scoreRed);\n    points.set(game.redTeam[1], points.get(game.redTeam[1]) + scoreRed);\n  }\n\n  points.forEach((value, key) => {\n    data.push({\n      name: players.get(key),\n      points: value\n    });\n  });\n  return data;\n} // Takes in a list of games and returns how often each player won (in relative terms).\n\nexport function getPlayerWinsSliceData(games, players) {\n  const data = []; // Should be of key: id, value: points.\n\n  const wins = new Map(Array.from(players.keys()).map(key => [key, 0]));\n  const totalGames = new Map(Array.from(players.keys()).map(key => [key, 0]));\n\n  for (let game of games) {\n    addTotalGames(game.blueTeam, game.redTeam, totalGames);\n\n    if (game.score[0] > game.score[1]) {\n      wins.set(game.blueTeam[0], wins.get(game.blueTeam[0]) + 1);\n      wins.set(game.blueTeam[1], wins.get(game.blueTeam[1]) + 1);\n    } else {\n      wins.set(game.redTeam[0], wins.get(game.redTeam[0]) + 1);\n      wins.set(game.redTeam[1], wins.get(game.redTeam[1]) + 1);\n    }\n  }\n\n  wins.forEach((value, key) => {\n    data.push({\n      name: players.get(key),\n      wins: value / totalGames.get(key)\n    });\n  });\n  return data;\n}\n\nfunction addTotalGames(blueTeam, redTeam, totalGames) {\n  totalGames.set(blueTeam[0], totalGames.get(blueTeam[0]) + 1);\n  totalGames.set(blueTeam[1], totalGames.get(blueTeam[1]) + 1);\n  totalGames.set(redTeam[0], totalGames.get(redTeam[0]) + 1);\n  totalGames.set(redTeam[1], totalGames.get(redTeam[1]) + 1);\n} // Gets a list of games and players and returns a list of PlayerWinsTreeDPs.\n\n\nexport function getPlayerWinsTreeData(games, players) {\n  const wins = new Map();\n  const losses = new Map();\n  players.forEach((value, key) => {\n    wins.set(key, 0);\n    losses.set(key, 0);\n  });\n\n  for (let game of games) {\n    const [winners, losers] = game.score[0] > game.score[1] ? [game.blueTeam, game.redTeam] : [game.redTeam, game.blueTeam];\n    console.log(\"Winners\", winners);\n    wins.set(winners[0], wins.get(winners[0]) + 1);\n    wins.set(winners[1], wins.get(winners[1]) + 1);\n    losses.set(losers[0], losses.get(losers[0]) + 1);\n    losses.set(losers[1], losses.get(losers[1]) + 1);\n  }\n\n  const data = [];\n  players.forEach((value, key) => {\n    const dataPoint = {\n      name: value,\n      children: [{\n        name: \"Wins\",\n        value: wins.get(key)\n      }, {\n        name: \"Losses\",\n        value: losses.get(key)\n      }]\n    };\n    data.push(dataPoint);\n  });\n  console.log(data);\n  return data;\n} // Gets a list of games and players and returns a map with a list of winrates over time mapped to\n// each players name.\n\nexport function getWinPercentage(games, players) {\n  const dataIds = new Map();\n  players.forEach((value, key) => dataIds.set(key, []));\n  const valuesPerPlayer = new Map();\n  players.forEach((value, key) => valuesPerPlayer.set(key, {\n    wins: 0,\n    total: 0\n  }));\n\n  for (let game of games) {\n    const player1 = game.blueTeam[0];\n    const player2 = game.blueTeam[1];\n    const player3 = game.redTeam[0];\n    const player4 = game.redTeam[1];\n    incrementNumTotal(player1, valuesPerPlayer);\n    incrementNumTotal(player2, valuesPerPlayer);\n    incrementNumTotal(player3, valuesPerPlayer);\n    incrementNumTotal(player4, valuesPerPlayer);\n\n    if (game.score[0] > game.score[1]) {\n      incrementNumWins(player1, valuesPerPlayer);\n      incrementNumWins(player2, valuesPerPlayer);\n    } else {\n      incrementNumWins(player3, valuesPerPlayer);\n      incrementNumWins(player4, valuesPerPlayer);\n    }\n\n    setNewWinPercentageDP(player1, game, valuesPerPlayer, dataIds);\n    setNewWinPercentageDP(player2, game, valuesPerPlayer, dataIds);\n    setNewWinPercentageDP(player3, game, valuesPerPlayer, dataIds);\n    setNewWinPercentageDP(player4, game, valuesPerPlayer, dataIds);\n  }\n\n  const finalData = new Map();\n  dataIds.forEach((value, key) => {\n    finalData.set(players.get(key), value);\n  });\n  return finalData;\n}\n\nfunction incrementNumTotal(id, valuesPerPlayer) {\n  const newPoint = _objectSpread({}, valuesPerPlayer.get(id));\n\n  newPoint.total = newPoint.total + 1;\n  valuesPerPlayer.set(id, newPoint);\n}\n\nfunction incrementNumWins(id, valuesPerPlayer) {\n  const playerScore = valuesPerPlayer.get(id);\n  valuesPerPlayer.set(id, _objectSpread(_objectSpread({}, playerScore), {}, {\n    wins: playerScore.wins + 1\n  }));\n}\n\nfunction setNewWinPercentageDP(id, game, valuesPerPlayer, dataIds) {\n  const values = valuesPerPlayer.get(id);\n  const dataPoint = {\n    date: game.date,\n    winPercentage: values.wins / values.total * 100\n  };\n  dataIds.set(id, [...dataIds.get(id), dataPoint]);\n}","map":{"version":3,"sources":["/Users/raphael/programming/web-projects/roundnet-stats/util/utils.tsx"],"names":["gameToRow","game","players","id","blueTeam","teamToString","redTeam","score","join","serve","date","team","map","playerId","get","getServeData","games","winPercentage","getServeWinPercentage","name","value","disabled","wins","filter","length","total","getPlayerPointsData","data","points","Map","Array","from","keys","key","scoreBlue","scoreRed","set","forEach","push","getPlayerWinsSliceData","totalGames","addTotalGames","getPlayerWinsTreeData","losses","winners","losers","console","log","dataPoint","children","getWinPercentage","dataIds","valuesPerPlayer","player1","player2","player3","player4","incrementNumTotal","incrementNumWins","setNewWinPercentageDP","finalData","newPoint","playerScore","values"],"mappings":"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","sourcesContent":["// This file provides helper functions to tranform the data from the server\n// into data the react components can use.\nimport {\n  Game,\n  Team,\n  Players,\n  ServeData,\n  PlayerPointsDataInstance,\n  PlayerWinsSliceDP,\n  PlayerWinsTreeDP,\n  WinPercentageDP,\n} from \"./types\";\n\n// Takes in a Game and converts it to the format used in the GameTable.\nexport function gameToRow(game: Game, players: Players) {\n  return {\n    id: game[\"id\"],\n    blueTeam: teamToString(game[\"blueTeam\"], players),\n    redTeam: teamToString(game[\"redTeam\"], players),\n    score: game[\"score\"].join(\":\"),\n    serve: game[\"serve\"],\n    date: game[\"date\"],\n  };\n}\n\nfunction teamToString(team: Team, players: Players): string {\n  return team.map((playerId) => players.get(playerId)).join(\", \");\n}\n\n// Takes in a list of Games and returns serveData.\nexport function getServeData(games: Game[]): ServeData {\n  const winPercentage = getServeWinPercentage(games);\n  return [\n    {\n      name: \"No Serve\",\n      value: 100 - winPercentage,\n      disabled: true,\n    },\n    {\n      name: \"Serve\",\n      value: winPercentage,\n    },\n  ];\n}\n\n// Takes in a list of Games and returns the win percentage of the team\n// with the inital serve.\nfunction getServeWinPercentage(games: Game[]): number {\n  const wins = games.filter((game) => {\n    return game.score[game.serve] > game.score[game.serve ? 0 : 1];\n  }).length;\n  const total = games.length;\n  return (wins / total) * 100;\n}\n\n// Takes in a list of games and all players, and returns how many points\n// each player scored.\nexport function getPlayerPointsData(\n  games: Game[],\n  players: Players\n): PlayerPointsDataInstance[] {\n  const data: PlayerPointsDataInstance[] = [];\n  // Should be of key: id, value: points.\n  const points = new Map(Array.from(players.keys()).map((key) => [key, 0]));\n  for (let game of games) {\n    const scoreBlue = game.score[0];\n    const scoreRed = game.score[1];\n    points.set(game.blueTeam[0], points.get(game.blueTeam[0]) + scoreBlue);\n    points.set(game.blueTeam[1], points.get(game.blueTeam[1]) + scoreBlue);\n    points.set(game.redTeam[0], points.get(game.redTeam[0]) + scoreRed);\n    points.set(game.redTeam[1], points.get(game.redTeam[1]) + scoreRed);\n  }\n  points.forEach((value, key) => {\n    data.push({ name: players.get(key), points: value });\n  });\n  return data;\n}\n\n// Takes in a list of games and returns how often each player won (in relative terms).\nexport function getPlayerWinsSliceData(\n  games: Game[],\n  players: Players\n): PlayerWinsSliceDP[] {\n  const data: PlayerWinsSliceDP[] = [];\n  // Should be of key: id, value: points.\n  const wins = new Map(Array.from(players.keys()).map((key) => [key, 0]));\n  const totalGames = new Map(Array.from(players.keys()).map((key) => [key, 0]));\n  for (let game of games) {\n    addTotalGames(game.blueTeam, game.redTeam, totalGames);\n    if (game.score[0] > game.score[1]) {\n      wins.set(game.blueTeam[0], wins.get(game.blueTeam[0]) + 1);\n      wins.set(game.blueTeam[1], wins.get(game.blueTeam[1]) + 1);\n    } else {\n      wins.set(game.redTeam[0], wins.get(game.redTeam[0]) + 1);\n      wins.set(game.redTeam[1], wins.get(game.redTeam[1]) + 1);\n    }\n  }\n  wins.forEach((value, key) => {\n    data.push({ name: players.get(key), wins: value / totalGames.get(key) });\n  });\n  return data;\n}\n\nfunction addTotalGames(\n  blueTeam: Team,\n  redTeam: Team,\n  totalGames: Map<string, number>\n): void {\n  totalGames.set(blueTeam[0], totalGames.get(blueTeam[0]) + 1);\n  totalGames.set(blueTeam[1], totalGames.get(blueTeam[1]) + 1);\n  totalGames.set(redTeam[0], totalGames.get(redTeam[0]) + 1);\n  totalGames.set(redTeam[1], totalGames.get(redTeam[1]) + 1);\n}\n\n// Gets a list of games and players and returns a list of PlayerWinsTreeDPs.\nexport function getPlayerWinsTreeData(\n  games: Game[],\n  players: Players\n): PlayerWinsTreeDP[] {\n  const wins = new Map<string, number>();\n  const losses = new Map<string, number>();\n  players.forEach((value, key) => {\n    wins.set(key, 0);\n    losses.set(key, 0);\n  });\n  for (let game of games) {\n    const [winners, losers] =\n      game.score[0] > game.score[1]\n        ? [game.blueTeam, game.redTeam]\n        : [game.redTeam, game.blueTeam];\n    console.log(\"Winners\", winners);\n    wins.set(winners[0], wins.get(winners[0]) + 1);\n    wins.set(winners[1], wins.get(winners[1]) + 1);\n    losses.set(losers[0], losses.get(losers[0]) + 1);\n    losses.set(losers[1], losses.get(losers[1]) + 1);\n  }\n  const data: PlayerWinsTreeDP[] = [];\n  players.forEach((value, key) => {\n    const dataPoint: PlayerWinsTreeDP = {\n      name: value,\n      children: [\n        { name: \"Wins\", value: wins.get(key) },\n        { name: \"Losses\", value: losses.get(key) },\n      ],\n    };\n    data.push(dataPoint);\n  });\n  console.log(data);\n  return data;\n}\n\n// Gets a list of games and players and returns a map with a list of winrates over time mapped to\n// each players name.\nexport function getWinPercentage(\n  games: Game[],\n  players: Players\n): Map<string, WinPercentageDP[]> {\n  const dataIds: Map<string, WinPercentageDP[]> = new Map();\n  players.forEach((value, key) => dataIds.set(key, []));\n  const valuesPerPlayer: Map<\n    string,\n    { wins: number; total: number }\n  > = new Map();\n  players.forEach((value, key) =>\n    valuesPerPlayer.set(key, { wins: 0, total: 0 })\n  );\n\n  for (let game of games) {\n    const player1 = game.blueTeam[0];\n    const player2 = game.blueTeam[1];\n    const player3 = game.redTeam[0];\n    const player4 = game.redTeam[1];\n    incrementNumTotal(player1, valuesPerPlayer);\n    incrementNumTotal(player2, valuesPerPlayer);\n    incrementNumTotal(player3, valuesPerPlayer);\n    incrementNumTotal(player4, valuesPerPlayer);\n    if (game.score[0] > game.score[1]) {\n      incrementNumWins(player1, valuesPerPlayer);\n      incrementNumWins(player2, valuesPerPlayer);\n    } else {\n      incrementNumWins(player3, valuesPerPlayer);\n      incrementNumWins(player4, valuesPerPlayer);\n    }\n    setNewWinPercentageDP(player1, game, valuesPerPlayer, dataIds);\n    setNewWinPercentageDP(player2, game, valuesPerPlayer, dataIds);\n    setNewWinPercentageDP(player3, game, valuesPerPlayer, dataIds);\n    setNewWinPercentageDP(player4, game, valuesPerPlayer, dataIds);\n  }\n  const finalData = new Map<string, WinPercentageDP[]>();\n  dataIds.forEach((value, key) => {\n    finalData.set(players.get(key), value);\n  });\n  return finalData;\n}\n\nfunction incrementNumTotal(\n  id: string,\n  valuesPerPlayer: Map<string, { wins: number; total: number }>\n): void {\n  const newPoint = { ...valuesPerPlayer.get(id) };\n  newPoint.total = newPoint.total + 1;\n  valuesPerPlayer.set(id, newPoint);\n}\n\nfunction incrementNumWins(\n  id: string,\n  valuesPerPlayer: Map<string, { wins: number; total: number }>\n): void {\n  const playerScore = valuesPerPlayer.get(id);\n  valuesPerPlayer.set(id, {\n    ...playerScore,\n    wins: playerScore.wins + 1,\n  });\n}\n\nfunction setNewWinPercentageDP(\n  id: string,\n  game: Game,\n  valuesPerPlayer: Map<string, { wins: number; total: number }>,\n  dataIds: Map<string, WinPercentageDP[]>\n) {\n  const values = valuesPerPlayer.get(id);\n  const dataPoint: WinPercentageDP = {\n    date: game.date,\n    winPercentage: (values.wins / values.total) * 100,\n  };\n  dataIds.set(id, [...dataIds.get(id), dataPoint]);\n}\n"]},"metadata":{},"sourceType":"module"}